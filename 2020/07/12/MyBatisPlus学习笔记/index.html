<!DOCTYPE html>
<html lang="zh-CN">





<head><meta name="generator" content="Hexo 3.8.0">
  <meta charset="UTF-8">
  <link rel="apple-touch-icon" sizes="76x76" href="/img/favicon.png">
  <link rel="icon" type="image/png" href="/img/favicon.png">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, shrink-to-fit=no">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  
  <meta name="theme-color" content="#2f4154">
  <meta name="description" content>
  <meta name="author" content="Guzhz">
  <meta name="keywords" content>
  <title>MyBatisPlus学习笔记 - Guzhz&#39;s House</title>

  <link rel="stylesheet" href="https://cdn.staticfile.org/twitter-bootstrap/4.4.1/css/bootstrap.min.css">


  <link rel="stylesheet" href="https://cdn.staticfile.org/github-markdown-css/4.0.0/github-markdown.min.css">
  <link rel="stylesheet" href="/lib/hint/hint.min.css">

  
    <link rel="stylesheet" href="https://cdn.staticfile.org/highlight.js/10.0.0/styles/github-gist.min.css">
  

  


<!-- 主题依赖的图标库，不要自行修改 -->
<link rel="stylesheet" href="//at.alicdn.com/t/font_1749284_yg9cfy8wd6.css">

<link rel="stylesheet" href="//at.alicdn.com/t/font_1736178_pjno9b9zyxs.css">

<link rel="stylesheet" href="/css/main.css">

<!-- 自定义样式保持在最底部 -->


  <script src="/js/utils.js"></script>
</head>


<body>
  <header style="height: 70vh;">
    <nav id="navbar" class="navbar fixed-top  navbar-expand-lg navbar-dark scrolling-navbar">
  <div class="container">
    <a class="navbar-brand" href="/">&nbsp;<strong>Guzhz's House</strong>&nbsp;</a>

    <button id="navbar-toggler-btn" class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
      <div class="animated-icon"><span></span><span></span><span></span></div>
    </button>

    <!-- Collapsible content -->
    <div class="collapse navbar-collapse" id="navbarSupportedContent">
      <ul class="navbar-nav ml-auto text-center">
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/">
                <i class="iconfont icon-home-fill"></i>
                首页
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/archives/">
                <i class="iconfont icon-archive-fill"></i>
                归档
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/categories/">
                <i class="iconfont icon-category-fill"></i>
                分类
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/tags/">
                <i class="iconfont icon-tags-fill"></i>
                标签
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/about/">
                <i class="iconfont icon-user-fill"></i>
                关于
              </a>
            </li>
          
        
        
          <li class="nav-item" id="search-btn">
            <a class="nav-link" data-toggle="modal" data-target="#modalSearch">&nbsp;&nbsp;<i class="iconfont icon-search"></i>&nbsp;&nbsp;</a>
          </li>
        
      </ul>
    </div>
  </div>
</nav>

    <div class="view intro-2" id="background" parallax=true
         style="background: url('/img/default.png') no-repeat center center;
           background-size: cover;">
      <div class="full-bg-img">
        <div class="mask flex-center" style="background-color: rgba(0, 0, 0, 0.3)">
          <div class="container text-center white-text fadeInUp">
            <span class="h2" id="subtitle">
              
            </span>

            
              
  <div class="mt-3 post-meta">
    <i class="iconfont icon-date-fill" aria-hidden="true"></i>
    <time datetime="2020-07-12 12:44">
      2020年7月12日 下午
    </time>
  </div>


<div class="mt-1">
  
    
    <span class="post-meta mr-2">
      <i class="iconfont icon-chart"></i>
      3.7k 字
    </span>
  

  
    
    <span class="post-meta mr-2">
      <i class="iconfont icon-clock-fill"></i>
      
      
      52
       分钟
    </span>
  

  
  
</div>

            
          </div>

          
        </div>
      </div>
    </div>
  </header>

  <main>
    
      

<div class="container-fluid">
  <div class="row">
    <div class="d-none d-lg-block col-lg-2"></div>
    <div class="col-lg-8 nopadding-md">
      <div class="container nopadding-md" id="board-ctn">
        <div class="py-5" id="board">
          <div class="post-content mx-auto" id="post">
            
            <article class="markdown-body">
              <p>前言：MyBatisPlus可以节省我们大量工作时间，所有的CRUD代码它都可以自动化完成！</p>
<hr>
<h1 id="特性"><a href="#特性" class="headerlink" title="特性"></a>特性</h1><ul>
<li>无侵入：只做增强不做改变，引入它不会对现有工程产生影响，如丝般顺滑</li>
<li>损耗小：启动即会自动注入基本 CURD，性能基本无损耗，直接面向对象操作， BaseMapper</li>
<li>强大的 CRUD 操作：内置通用 Mapper、通用 Service，仅仅通过少量配置即可实现单表大部分CRUD 操作，更有强大的条件构造器，满足各类使用需求, 以后简单的CRUD操作，它不用自己编写了！</li>
<li>支持 Lambda 形式调用：通过 Lambda 表达式，方便的编写各类查询条件，无需再担心字段写错</li>
<li>支持主键自动生成：支持多达 4 种主键策略（内含分布式唯一 ID 生成器 - Sequence），可自由配置，完美解决主键问题</li>
<li>支持 ActiveRecord 模式：支持 ActiveRecord 形式调用，实体类只需继承 Model 类即可进行强大的 CRUD 操作</li>
<li>支持自定义全局通用操作：支持全局通用方法注入（ Write once, use anywhere ）</li>
<li>内置代码生成器：采用代码或者 Maven 插件可快速生成 Mapper 、 Model 、 Service 、Controller 层代码，支持模板引擎，更有超多自定义配置等您来使用（自动帮你生成代码）</li>
<li>内置分页插件：基于 MyBatis 物理分页，开发者无需关心具体操作，配置好插件之后，写分页等同于普通 List 查询</li>
<li>分页插件支持多种数据库：支持 MySQL、MariaDB、Oracle、DB2、H2、HSQL、SQLite、Postgre、SQLServer 等多种数据库</li>
<li>内置性能分析插件：可输出 Sql 语句以及其执行时间，建议开发测试时启用该功能，能快速揪出慢查询</li>
<li>内置全局拦截插件：提供全表 delete 、 update 操作智能分析阻断，也可自定义拦截规则，预防误操作</li>
</ul>
<hr>
<h1 id="快速入门"><a href="#快速入门" class="headerlink" title="快速入门"></a>快速入门</h1><p>1、创建数据库<br>2、创建表(id自增)<br><pre><code class="hljs java">DROP TABLE IF EXISTS user;
<span class="hljs-function">CREATE TABLE <span class="hljs-title">user</span>
<span class="hljs-params">(
    id BIGINT(<span class="hljs-number">20</span>)</span> NOT NULL COMMENT '主键ID',
    name <span class="hljs-title">VARCHAR</span><span class="hljs-params">(<span class="hljs-number">30</span>)</span> NULL DEFAULT NULL COMMENT '姓名',
    age <span class="hljs-title">INT</span><span class="hljs-params">(<span class="hljs-number">11</span>)</span> NULL DEFAULT NULL COMMENT '年龄',
    email <span class="hljs-title">VARCHAR</span><span class="hljs-params">(<span class="hljs-number">50</span>)</span> NULL DEFAULT NULL COMMENT '邮箱',
    PRIMARY <span class="hljs-title">KEY</span> <span class="hljs-params">(id)</span>
)</span>;

<span class="hljs-function">INSERT INTO <span class="hljs-title">user</span> <span class="hljs-params">(id, name, age, email)</span> <span class="hljs-title">VALUES</span>
<span class="hljs-params">(<span class="hljs-number">1</span>, <span class="hljs-string">'Jone'</span>, <span class="hljs-number">18</span>, <span class="hljs-string">'test1@baomidou.com'</span>)</span>,
<span class="hljs-params">(<span class="hljs-number">2</span>, <span class="hljs-string">'Jack'</span>, <span class="hljs-number">20</span>, <span class="hljs-string">'test2@baomidou.com'</span>)</span>,
<span class="hljs-params">(<span class="hljs-number">3</span>, <span class="hljs-string">'Tom'</span>, <span class="hljs-number">28</span>, <span class="hljs-string">'test3@baomidou.com'</span>)</span>,
<span class="hljs-params">(<span class="hljs-number">4</span>, <span class="hljs-string">'Sandy'</span>, <span class="hljs-number">21</span>, <span class="hljs-string">'test4@baomidou.com'</span>)</span>,
<span class="hljs-params">(<span class="hljs-number">5</span>, <span class="hljs-string">'Billie'</span>, <span class="hljs-number">24</span>, <span class="hljs-string">'test5@baomidou.com'</span>)</span></span>;
-- 真实开发中，version（乐观锁）、deleted（逻辑删除）、gmt_create、gmt_modified</code></pre></p>
<p>3、编写项目，初始化项目，使用SpringBoot初始化<br>4、导入依赖<br><pre><code class="hljs java">&lt;!-- 数据库驱动 --&gt;
&lt;dependency&gt;
    &lt;groupId&gt;mysql&lt;/groupId&gt;
    &lt;artifactId&gt;mysql-connector-java&lt;/artifactId&gt;
&lt;/dependency&gt;
&lt;!-- lombok --&gt;
&lt;dependency&gt;
    &lt;groupId&gt;org.projectlombok&lt;/groupId&gt;
    &lt;artifactId&gt;lombok&lt;/artifactId&gt;
&lt;/dependency&gt;
&lt;!-- mybatis-plus --&gt;
&lt;!-- mybatis-plus 是自己开发，并非官方的！ --&gt;
&lt;dependency&gt;
    &lt;groupId&gt;com.baomidou&lt;/groupId&gt;
    &lt;artifactId&gt;mybatis-plus-boot-starter&lt;/artifactId&gt;
    &lt;version&gt;3.0.5&lt;/version&gt;
&lt;/dependency&gt;</code></pre></p>
<p>5、连接数据库<br><pre><code class="hljs java">spring.datasource.username=root
spring.datasource.password=<span class="hljs-number">123456</span>
spring.datasource.url=jdbc:mysql:<span class="hljs-comment">//localhost:3306/mybatis_plus?useSSL=false&amp;useUnicode=true&amp;characterEncoding=utf-8&amp;serverTimezone=GMT%2B8</span>
spring.datasource.driver-<span class="hljs-class"><span class="hljs-keyword">class</span>-<span class="hljs-title">name</span></span>=com.mysql.cj.jdbc.Driver</code></pre></p>
<p>6、编写基本pojo类<br><pre><code class="hljs java"><span class="hljs-meta">@Data</span>
<span class="hljs-meta">@AllArgsConstructor</span>
<span class="hljs-meta">@NoArgsConstructor</span>
<span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">User</span> </span>&#123;
    <span class="hljs-keyword">private</span> Long id;
    <span class="hljs-keyword">private</span> String name;
    <span class="hljs-keyword">private</span> Integer age;
    <span class="hljs-keyword">private</span> String email;
&#125;</code></pre></p>
<p>7、mapper接口<br><pre><code class="hljs java"><span class="hljs-meta">@Repository</span> <span class="hljs-comment">// 代表持久层</span>
<span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">interface</span> <span class="hljs-title">UserMapper</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">BaseMapper</span>&lt;<span class="hljs-title">User</span>&gt; </span>&#123;
    <span class="hljs-comment">// 所有的CRUD操作都已经编写完成了</span>
    <span class="hljs-comment">// 你不需要像以前的配置一大堆文件了！</span>
&#125;</code></pre></p>
<ul>
<li><p>注意点：我们需要在主启动类上去扫描我们的mapper包下的所有接口<br><code>@MapperScan(&quot;com.kuang.mapper&quot;)</code></p>
</li>
<li><p>测试类：</p>
<pre><code class="hljs java"><span class="hljs-meta">@SpringBootTest</span>
<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">MybatisPlusApplicationTests</span> </span>&#123;
    <span class="hljs-comment">// 继承了BaseMapper，所有的方法都来自己父类</span>
    <span class="hljs-comment">// 我们也可以编写自己的扩展方法！</span>
    <span class="hljs-meta">@Autowired</span>
    <span class="hljs-keyword">private</span> UserMapper userMapper;

    <span class="hljs-meta">@Test</span>
    <span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">contextLoads</span><span class="hljs-params">()</span> </span>&#123;
        <span class="hljs-comment">// 参数是一个 Wrapper ，条件构造器，这里我们先不用 null</span>
        <span class="hljs-comment">// 查询全部用户</span>
        List&lt;User&gt; users = userMapper.selectList(<span class="hljs-keyword">null</span>);
        users.forEach(System.out::println);
    &#125;
&#125;</code></pre>
</li>
</ul>
<hr>
<h1 id="配置日志"><a href="#配置日志" class="headerlink" title="配置日志"></a>配置日志</h1><p>我们所有的sql现在是不可见的，我们希望知道它是怎么执行的，所以我们必须要看日志！<br><pre><code class="hljs java">mybatis-plus.configuration.log-impl=org.apache.ibatis.logging.stdout.StdOutImpl</code></pre></p>
<hr>
<h1 id="CRUD拓展"><a href="#CRUD拓展" class="headerlink" title="CRUD拓展"></a>CRUD拓展</h1><h4 id="1、插入操作"><a href="#1、插入操作" class="headerlink" title="1、插入操作"></a>1、插入操作</h4><pre><code class="hljs java"><span class="hljs-comment">// 测试插入</span>
<span class="hljs-meta">@Test</span>
<span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">testInsert</span><span class="hljs-params">()</span></span>&#123;
    User user = <span class="hljs-keyword">new</span> User();
    user.setName(<span class="hljs-string">"狂神说Java"</span>);
    user.setAge(<span class="hljs-number">3</span>);
    user.setEmail(<span class="hljs-string">"24736743@qq.com"</span>);
    <span class="hljs-keyword">int</span> result = userMapper.insert(user); <span class="hljs-comment">// 帮我们自动生成id</span>
    System.out.println(result); <span class="hljs-comment">// 受影响的行数</span>
    System.out.println(user); <span class="hljs-comment">// 发现，id会自动回填</span>
&#125;</code></pre>
<p>？出现的问题：默认id为全局唯一id：ID_WORKER，是根据雪花算法生成的。</p>
<h4 id="2、主键生成策略"><a href="#2、主键生成策略" class="headerlink" title="2、主键生成策略"></a>2、主键生成策略</h4><p><strong>雪花算法：</strong><br>snowflake是Twitter开源的分布式ID生成算法，结果是一个long型的ID。其核心思想是：使用41bit作为毫秒数，10bit作为机器的ID（5个bit是数据中心，5个bit的机器ID），12bit作为毫秒内的流水号（意味着每个节点在每毫秒可以产生 4096 个 ID），最后还有一个符号位，永远是0。可以保证几乎全球唯一！<br><strong>配置id自增方法：</strong><br>1、实体类字段上 <code>@TableId(type = IdType.AUTO)</code><br>2、数据库自增<br><pre><code class="hljs java">IdType解释：
<span class="hljs-keyword">public</span> <span class="hljs-keyword">enum</span> IdType &#123;
    AUTO(<span class="hljs-number">0</span>), <span class="hljs-comment">// 数据库id自增</span>
    NONE(<span class="hljs-number">1</span>), <span class="hljs-comment">// 未设置主键</span>
    INPUT(<span class="hljs-number">2</span>), <span class="hljs-comment">// 手动输入</span>
    ID_WORKER(<span class="hljs-number">3</span>), <span class="hljs-comment">// 默认的全局唯一id</span>
    UUID(<span class="hljs-number">4</span>), <span class="hljs-comment">// 全局唯一id uuid</span>
    ID_WORKER_STR(<span class="hljs-number">5</span>); <span class="hljs-comment">//ID_WORKER 字符串表示法</span>
&#125;</code></pre></p>
<h4 id="3、更新操作"><a href="#3、更新操作" class="headerlink" title="3、更新操作"></a>3、更新操作</h4><pre><code class="hljs java"><span class="hljs-comment">// 测试更新</span>
<span class="hljs-meta">@Test</span>
<span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">testUpdate</span><span class="hljs-params">()</span></span>&#123;
    User user = <span class="hljs-keyword">new</span> User();
    <span class="hljs-comment">// 通过条件自动拼接动态sql</span>
    user.setId(<span class="hljs-number">6L</span>);
    user.setName(<span class="hljs-string">"关注公众号：狂神说"</span>);
    user.setAge(<span class="hljs-number">18</span>);
    <span class="hljs-comment">// 注意：updateById 但是参数是一个 对象！</span>
    <span class="hljs-keyword">int</span> i = userMapper.updateById(user);
    System.out.println(i);
&#125;</code></pre>
<h4 id="4、自动填充机制：创建时间、更新时间"><a href="#4、自动填充机制：创建时间、更新时间" class="headerlink" title="4、自动填充机制：创建时间、更新时间"></a>4、自动填充机制：创建时间、更新时间</h4><p>创建时间、修改时间！这些个操作一遍都是自动化完成的，我们不希望手动更新！<br>阿里巴巴开发手册：所有的数据库表：gmt_create、gmt_modified几乎所有的表都要配置上！而且需要自动化！</p>
<blockquote>
<p>方式一：修改数据库设置（工作中不允许你直接修改数据库）</p>
</blockquote>
<p>1、在表中新增字段 create_time, update_time（提供更新）<br>2、再次测试插入方法，我们需要先把实体类同步！<br><pre><code class="hljs java"><span class="hljs-keyword">private</span> Date createTime;
<span class="hljs-keyword">private</span> Date updateTime;</code></pre></p>
<blockquote>
<p>方式二：代码操作</p>
</blockquote>
<p>1、只添加字段<br>2、实体类字段属性上需要增加注解<br><pre><code class="hljs java"><span class="hljs-comment">// 字段添加填充内容</span>
<span class="hljs-meta">@TableField</span>(fill = FieldFill.INSERT)
<span class="hljs-keyword">private</span> Date createTime;

<span class="hljs-meta">@TableField</span>(fill = FieldFill.INSERT_UPDATE)
<span class="hljs-keyword">private</span> Date updateTime;</code></pre></p>
<p>3、处理器类处理注解<br><pre><code class="hljs java"><span class="hljs-keyword">package</span> com.kuang.handler;
<span class="hljs-keyword">import</span> com.baomidou.mybatisplus.core.handlers.MetaObjectHandler;
<span class="hljs-keyword">import</span> lombok.extern.slf4j.Slf4j;
<span class="hljs-keyword">import</span> org.apache.ibatis.reflection.MetaObject;
<span class="hljs-keyword">import</span> org.springframework.stereotype.Component;
<span class="hljs-keyword">import</span> java.util.Date;
<span class="hljs-meta">@Slf</span>4j      <span class="hljs-comment">//日志注解</span>
<span class="hljs-meta">@Component</span> <span class="hljs-comment">// 一定不要忘记把处理器加到IOC容器中！</span>
<span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">MyMetaObjectHandler</span> <span class="hljs-keyword">implements</span> <span class="hljs-title">MetaObjectHandler</span> </span>&#123;
    <span class="hljs-comment">// 插入时的填充策略</span>
    <span class="hljs-meta">@Override</span>
    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">insertFill</span><span class="hljs-params">(MetaObject metaObject)</span> </span>&#123;
        log.info(<span class="hljs-string">"start insert fill....."</span>);
        <span class="hljs-comment">// setFieldValByName(String fieldName, Object fieldVal, MetaObject</span>
        metaObject
        <span class="hljs-keyword">this</span>.setFieldValByName(<span class="hljs-string">"createTime"</span>,<span class="hljs-keyword">new</span> Date(),metaObject);
        <span class="hljs-keyword">this</span>.setFieldValByName(<span class="hljs-string">"updateTime"</span>,<span class="hljs-keyword">new</span> Date(),metaObject);
    &#125;
    <span class="hljs-comment">// 更新时的填充策略</span>
    <span class="hljs-meta">@Override</span>
    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">updateFill</span><span class="hljs-params">(MetaObject metaObject)</span> </span>&#123;
        log.info(<span class="hljs-string">"start update fill....."</span>);
        <span class="hljs-keyword">this</span>.setFieldValByName(<span class="hljs-string">"updateTime"</span>,<span class="hljs-keyword">new</span> Date(),metaObject);
    &#125;
&#125;</code></pre></p>
<p>4、测试插入、更新操作</p>
<h4 id="5、乐观锁"><a href="#5、乐观锁" class="headerlink" title="5、乐观锁"></a>5、乐观锁</h4><blockquote>
<p>乐观锁 : 故名思意十分乐观，它总是认为不会出现问题，无论干什么不去上锁！如果出现了问题，再次更新值测试<br>悲观锁：故名思意十分悲观，它总是认为总是出现问题，无论干什么都会上锁！再去操作！</p>
</blockquote>
<p>实现原理：添加version字段</p>
<ul>
<li>取出记录时，获取当前 version</li>
<li>更新时，带上这个version</li>
<li>执行更新时， set version = newVersion where version = oldVersion</li>
<li>如果version不对，就更新失败</li>
</ul>
<pre><code class="hljs java">乐观锁：<span class="hljs-number">1</span>、先查询，获得版本号 version = <span class="hljs-number">1</span>
-- A
update user set name = <span class="hljs-string">"kuangshen"</span>, version = version + <span class="hljs-number">1</span>
where id = <span class="hljs-number">2</span> and version = <span class="hljs-number">1</span>

-- B 线程抢先完成，这个时候 version = <span class="hljs-number">2</span>，会导致 A 修改失败！
update user set name = <span class="hljs-string">"kuangshen"</span>, version = version + <span class="hljs-number">1</span>
where id = <span class="hljs-number">2</span> and version = <span class="hljs-number">1</span></code></pre>
<p>1、数据库添加version字段，int，默认值为1<br>2、实体类添加对应的字段<br><pre><code class="hljs java"><span class="hljs-meta">@Version</span> <span class="hljs-comment">//乐观锁Version注解</span>
<span class="hljs-keyword">private</span> Integer version;</code></pre></p>
<p>3、注册插件：编写配置类，把扫描声明放来这里，添加事务管理注解<br><pre><code class="hljs java"><span class="hljs-comment">// 扫描我们的 mapper 文件夹</span>
<span class="hljs-meta">@MapperScan</span>(<span class="hljs-string">"com.kuang.mapper"</span>)
<span class="hljs-meta">@EnableTransactionManagement</span>
<span class="hljs-meta">@Configuration</span> <span class="hljs-comment">// 配置类</span>
<span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">MyBatisPlusConfig</span> </span>&#123;
    <span class="hljs-comment">// 注册乐观锁插件</span>
    <span class="hljs-meta">@Bean</span>
        <span class="hljs-function"><span class="hljs-keyword">public</span> OptimisticLockerInterceptor <span class="hljs-title">optimisticLockerInterceptor</span><span class="hljs-params">()</span> </span>&#123;
        <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> OptimisticLockerInterceptor();
    &#125;
&#125;</code></pre></p>
<p>4、测试<br><pre><code class="hljs java"><span class="hljs-comment">// 测试乐观锁成功！</span>
<span class="hljs-meta">@Test</span>
<span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">testOptimisticLocker</span><span class="hljs-params">()</span></span>&#123;
    <span class="hljs-comment">// 1、查询用户信息</span>
    User user = userMapper.selectById(<span class="hljs-number">1L</span>);
    <span class="hljs-comment">// 2、修改用户信息</span>
    user.setName(<span class="hljs-string">"kuangshen"</span>);
    user.setEmail(<span class="hljs-string">"24736743@qq.com"</span>);
    <span class="hljs-comment">// 3、执行更新操作</span>
    userMapper.updateById(user);
&#125;</code></pre></p>
<pre><code class="hljs java"><span class="hljs-comment">// 测试乐观锁失败！多线程下</span>
<span class="hljs-meta">@Test</span>
<span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">testOptimisticLocker2</span><span class="hljs-params">()</span></span>&#123;
    <span class="hljs-comment">// 线程 1</span>
    User user = userMapper.selectById(<span class="hljs-number">1L</span>);
    user.setName(<span class="hljs-string">"kuangshen111"</span>);
    user.setEmail(<span class="hljs-string">"24736743@qq.com"</span>);
    <span class="hljs-comment">// 模拟另外一个线程执行了插队操作</span>
    User user2 = userMapper.selectById(<span class="hljs-number">1L</span>);
    user2.setName(<span class="hljs-string">"kuangshen222"</span>);
    user2.setEmail(<span class="hljs-string">"24736743@qq.com"</span>);
    userMapper.updateById(user2);
    <span class="hljs-comment">// 自旋锁来多次尝试提交！</span>
    userMapper.updateById(user); <span class="hljs-comment">// 如果没有乐观锁就会覆盖插队线程的值！</span>
&#125;</code></pre>
<h4 id="6、查询操作"><a href="#6、查询操作" class="headerlink" title="6、查询操作"></a>6、查询操作</h4><pre><code class="hljs java"><span class="hljs-comment">// 测试查询</span>
<span class="hljs-meta">@Test</span>
<span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">testSelectById</span><span class="hljs-params">()</span></span>&#123;
    User user = userMapper.selectById(<span class="hljs-number">1L</span>);
    System.out.println(user);
&#125;

<span class="hljs-comment">// 测试批量查询！</span>
<span class="hljs-meta">@Test</span>
<span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">testSelectByBatchId</span><span class="hljs-params">()</span></span>&#123;
    List&lt;User&gt; users = userMapper.selectBatchIds(Arrays.asList(<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>));
    users.forEach(System.out::println);
&#125;

<span class="hljs-comment">// 按条件查询之一使用map操作</span>
<span class="hljs-meta">@Test</span>
<span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">testSelectByBatchIds</span><span class="hljs-params">()</span></span>&#123;
    HashMap&lt;String, Object&gt; map = <span class="hljs-keyword">new</span> HashMap&lt;&gt;();
    <span class="hljs-comment">// 自定义要查询</span>
    map.put(<span class="hljs-string">"name"</span>,<span class="hljs-string">"狂神说Java"</span>);
    map.put(<span class="hljs-string">"age"</span>,<span class="hljs-number">3</span>);
    List&lt;User&gt; users = userMapper.selectByMap(map);
    users.forEach(System.out::println);
&#125;</code></pre>
<h4 id="7、分页查询（内置）"><a href="#7、分页查询（内置）" class="headerlink" title="7、分页查询（内置）"></a>7、分页查询（内置）</h4><p>1、配置组件<br><pre><code class="hljs java"><span class="hljs-comment">// 分页插件</span>
<span class="hljs-meta">@Bean</span>
    <span class="hljs-function"><span class="hljs-keyword">public</span> PaginationInterceptor <span class="hljs-title">paginationInterceptor</span><span class="hljs-params">()</span> </span>&#123;
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> PaginationInterceptor();
&#125;</code></pre></p>
<p>2、直接使用Page对象<br><pre><code class="hljs java"><span class="hljs-comment">// 测试分页查询</span>
<span class="hljs-meta">@Test</span>
<span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">testPage</span><span class="hljs-params">()</span></span>&#123;
    <span class="hljs-comment">// 参数一：当前页</span>
    <span class="hljs-comment">// 参数二：页面大小</span>
    <span class="hljs-comment">// 使用了分页插件之后，所有的分页操作也变得简单的！</span>
    Page&lt;User&gt; page = <span class="hljs-keyword">new</span> Page&lt;&gt;(<span class="hljs-number">2</span>,<span class="hljs-number">5</span>);
    userMapper.selectPage(page,<span class="hljs-keyword">null</span>);
    page.getRecords().forEach(System.out::println);
    System.out.println(page.getTotal());
&#125;</code></pre></p>
<h4 id="8、删除操作"><a href="#8、删除操作" class="headerlink" title="8、删除操作"></a>8、删除操作</h4><p>1、根据id删除记录<br><pre><code class="hljs java"><span class="hljs-comment">// 测试删除</span>
<span class="hljs-meta">@Test</span>
<span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">testDeleteById</span><span class="hljs-params">()</span></span>&#123;
    userMapper.deleteById(<span class="hljs-number">1240620674645544965L</span>);
&#125;

<span class="hljs-comment">// 通过id批量删除</span>
<span class="hljs-meta">@Test</span>
<span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">testDeleteBatchId</span><span class="hljs-params">()</span></span>&#123;
    userMapper.deleteBatchIds(Arrays.asList(<span class="hljs-number">1L</span>,<span class="hljs-number">2L</span>));
&#125;

<span class="hljs-comment">// 通过map删除</span>
<span class="hljs-meta">@Test</span>
<span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">testDeleteMap</span><span class="hljs-params">()</span></span>&#123;
    HashMap&lt;String, Object&gt; map = <span class="hljs-keyword">new</span> HashMap&lt;&gt;();
    map.put(<span class="hljs-string">"name"</span>,<span class="hljs-string">"狂神说Java"</span>);
    userMapper.deleteByMap(map);
&#125;</code></pre></p>
<h4 id="9、逻辑删除"><a href="#9、逻辑删除" class="headerlink" title="9、逻辑删除"></a>9、逻辑删除</h4><blockquote>
<p>物理删除 ：从数据库中直接移除<br>逻辑删除 ：再数据库中没有被移除，而是通过一个变量来让他失效！ deleted = 0 =&gt; deleted = 1</p>
</blockquote>
<p>管理员可以查看被删除的记录！防止数据的丢失，类似于回收站！<br>（原理：更新deleted字段，但同时查询也是将无结果）<br>1、在数据表中增加一个 deleted 字段（int 默认0）<br>2、实体类中增加属性<br><pre><code class="hljs java"><span class="hljs-meta">@TableLogic</span> <span class="hljs-comment">//逻辑删除</span>
<span class="hljs-keyword">private</span> Integer deleted;</code></pre></p>
<p>3、配置组件<br><pre><code class="hljs java"><span class="hljs-comment">// 逻辑删除组件！</span>
<span class="hljs-meta">@Bean</span>
<span class="hljs-function"><span class="hljs-keyword">public</span> ISqlInjector <span class="hljs-title">sqlInjector</span><span class="hljs-params">()</span> </span>&#123;
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> LogicSqlInjector();
&#125;</code></pre></p>
<pre><code class="hljs java"># 配置逻辑删除
mybatis-plus.global-config.db-config.logic-delete-value=1
mybatis-plus.global-config.db-config.logic-not-delete-value=0</code></pre>
<h4 id="10、性能分析插件"><a href="#10、性能分析插件" class="headerlink" title="10、性能分析插件"></a>10、性能分析插件</h4><p>我们在平时的开发中，会遇到一些慢sql。测试！ druid……<br>作用：性能分析拦截器，用于输出每条 SQL 语句及其执行时间，<br>MyBatisPlus也提供性能分析插件，如果超过这个时间就停止运行！<br>1、导入插件<br><pre><code class="hljs java"><span class="hljs-comment">/**
* SQL执行效率插件
*/</span>
<span class="hljs-meta">@Bean</span>
<span class="hljs-meta">@Profile</span>(&#123;<span class="hljs-string">"dev"</span>,<span class="hljs-string">"test"</span>&#125;)<span class="hljs-comment">// 设置 dev test 环境开启，保证我们的效率</span>
<span class="hljs-function"><span class="hljs-keyword">public</span> PerformanceInterceptor <span class="hljs-title">performanceInterceptor</span><span class="hljs-params">()</span> </span>&#123;
    PerformanceInterceptor performanceInterceptor = <span class="hljs-keyword">new</span> PerformanceInterceptor();
    performanceInterceptor.setMaxTime(<span class="hljs-number">100</span>); <span class="hljs-comment">// ms设置sql执行的最大时间，如果超过了则不执行</span>
    performanceInterceptor.setFormat(<span class="hljs-keyword">true</span>); <span class="hljs-comment">// 是否格式化代码</span>
    <span class="hljs-keyword">return</span> performanceInterceptor;
&#125;</code></pre></p>
<p><code>记住，要在SpringBoot中配置环境为dev或者 test 环境！</code><br>2、测试使用<br><pre><code class="hljs java"><span class="hljs-meta">@Test</span>
<span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">contextLoads</span><span class="hljs-params">()</span> </span>&#123;
    <span class="hljs-comment">// 参数是一个 Wrapper ，条件构造器，这里我们先不用 null</span>
    <span class="hljs-comment">// 查询全部用户</span>
    List&lt;User&gt; users = userMapper.selectList(<span class="hljs-keyword">null</span>);
    users.forEach(System.out::println);
&#125;</code></pre></p>
<h4 id="11、条件构造器"><a href="#11、条件构造器" class="headerlink" title="11、条件构造器"></a>11、条件构造器</h4><p>十分重要：Wrapper<br>我们写一些复杂的sql就可以使用它来替代！<br><strong>1、限定非空条件</strong><br><pre><code class="hljs java"><span class="hljs-meta">@Test</span>
<span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">contextLoads</span><span class="hljs-params">()</span> </span>&#123;
    <span class="hljs-comment">// 查询name不为空的用户，并且邮箱不为空的用户，年龄大于等于12</span>
    QueryWrapper&lt;User&gt; wrapper = <span class="hljs-keyword">new</span> QueryWrapper&lt;&gt;();
    wrapper
        .isNotNull(<span class="hljs-string">"name"</span>)
        .isNotNull(<span class="hljs-string">"email"</span>)
        .ge(<span class="hljs-string">"age"</span>,<span class="hljs-number">12</span>);
    userMapper.selectList(wrapper).forEach(System.out::println); <span class="hljs-comment">// 和我们刚才学习的map对比一下</span>
&#125;</code></pre></p>
<p><strong>2、限定字段等于某个值</strong><br><pre><code class="hljs java"><span class="hljs-meta">@Test</span>
<span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">test2</span><span class="hljs-params">()</span></span>&#123;
    <span class="hljs-comment">// 查询名字狂神说</span>
    QueryWrapper&lt;User&gt; wrapper = <span class="hljs-keyword">new</span> QueryWrapper&lt;&gt;();
    wrapper.eq(<span class="hljs-string">"name"</span>,<span class="hljs-string">"狂神说"</span>);
    User user = userMapper.selectOne(wrapper); <span class="hljs-comment">// 查询一个数据，出现多个结果使用List或者 Map</span>
    System.out.println(user);
&#125;</code></pre></p>
<p><strong>3、限定字段值为某个区间</strong><br><pre><code class="hljs java"><span class="hljs-meta">@Test</span>
<span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">test3</span><span class="hljs-params">()</span></span>&#123;
    <span class="hljs-comment">// 查询年龄在 20 ~ 30 岁之间的用户</span>
    QueryWrapper&lt;User&gt; wrapper = <span class="hljs-keyword">new</span> QueryWrapper&lt;&gt;();
    wrapper.between(<span class="hljs-string">"age"</span>,<span class="hljs-number">20</span>,<span class="hljs-number">30</span>); <span class="hljs-comment">// 区间</span>
    Integer count = userMapper.selectCount(wrapper);<span class="hljs-comment">// 查询结果数</span>
    System.out.println(count);
&#125;</code></pre></p>
<p><strong>4、模糊查询</strong><br><pre><code class="hljs java"><span class="hljs-comment">// 模糊查询</span>
<span class="hljs-meta">@Test</span>
<span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">test4</span><span class="hljs-params">()</span></span>&#123;
    QueryWrapper&lt;User&gt; wrapper = <span class="hljs-keyword">new</span> QueryWrapper&lt;&gt;();
    <span class="hljs-comment">// 左和右 t%</span>
    wrapper
        .notLike(<span class="hljs-string">"name"</span>,<span class="hljs-string">"e"</span>)
        .likeRight(<span class="hljs-string">"email"</span>,<span class="hljs-string">"t"</span>);
    List&lt;Map&lt;String, Object&gt;&gt; maps = userMapper.selectMaps(wrapper);
    maps.forEach(System.out::println);
&#125;</code></pre></p>
<p><strong>5、id条件从子查询中得来</strong><br><pre><code class="hljs java"><span class="hljs-meta">@Test</span>
<span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">test5</span><span class="hljs-params">()</span></span>&#123;
    QueryWrapper&lt;User&gt; wrapper = <span class="hljs-keyword">new</span> QueryWrapper&lt;&gt;();
    <span class="hljs-comment">// id 在子查询中查出来</span>
    wrapper.inSql(<span class="hljs-string">"id"</span>,<span class="hljs-string">"select id from user where id&lt;3"</span>);
    List&lt;Object&gt; objects = userMapper.selectObjs(wrapper);
    objects.forEach(System.out::println);
&#125;</code></pre></p>
<p>6、根据id进行排序<br><pre><code class="hljs java"><span class="hljs-meta">@Test</span>
<span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">test6</span><span class="hljs-params">()</span></span>&#123;
    QueryWrapper&lt;User&gt; wrapper = <span class="hljs-keyword">new</span> QueryWrapper&lt;&gt;();
    <span class="hljs-comment">// 通过id进行升序排序</span>
    wrapper.orderByAsc(<span class="hljs-string">"id"</span>);
    List&lt;User&gt; users = userMapper.selectList(wrapper);
    users.forEach(System.out::println);
&#125;</code></pre></p>
<h4 id="12、代码自动生成器"><a href="#12、代码自动生成器" class="headerlink" title="12、代码自动生成器"></a>12、代码自动生成器</h4><p>dao、pojo、service、controller都给我自己去编写完成！<br>AutoGenerator 是 MyBatis-Plus 的代码生成器，通过 AutoGenerator 可以快速生成 Entity、Mapper、Mapper XML、Service、Controller 等各个模块的代码，极大的提升了开发效率。</p>
<p>代码：<br><pre><code class="hljs java">package com.kuang;
import com.baomidou.mybatisplus.annotation.DbType;
import com.baomidou.mybatisplus.annotation.FieldFill;
import com.baomidou.mybatisplus.annotation.IdType;
import com.baomidou.mybatisplus.annotation.TableField;
import com.baomidou.mybatisplus.generator.AutoGenerator;
import com.baomidou.mybatisplus.generator.config.DataSourceConfig;
import com.baomidou.mybatisplus.generator.config.GlobalConfig;
import com.baomidou.mybatisplus.generator.config.PackageConfig;
import com.baomidou.mybatisplus.generator.config.StrategyConfig;
import com.baomidou.mybatisplus.generator.config.po.TableFill;
import com.baomidou.mybatisplus.generator.config.rules.DateType;
import com.baomidou.mybatisplus.generator.config.rules.NamingStrategy;
import java.util.ArrayList;
// 代码自动生成器
public class KuangCode &#123;
    public static void main(String[] args) &#123;
        // 需要构建一个 代码自动生成器 对象
        AutoGenerator mpg = new AutoGenerator();
        // 配置策略
        // 1、全局配置
        GlobalConfig gc = new GlobalConfig();
        String projectPath = System.getProperty("user.dir");
        gc.setOutputDir(projectPath+"/src/main/java");
        gc.setAuthor("狂神说");
        gc.setOpen(false);
        gc.setFileOverride(false); // 是否覆盖
        gc.setServiceName("%sService"); // 去Service的I前缀
        gc.setIdType(IdType.ID_WORKER);
        gc.setDateType(DateType.ONLY_DATE);
        gc.setSwagger2(true);
        mpg.setGlobalConfig(gc);
        
        //2、设置数据源
        DataSourceConfig dsc = new DataSourceConfig();
        dsc.setUrl("jdbc:mysql://localhost:3306/kuang_community?
        useSSL=false&amp;useUnicode=true&amp;characterEncoding=utf-8&amp;serverTimezone=GMT%2B8");
        dsc.setDriverName("com.mysql.cj.jdbc.Driver");
        dsc.setUsername("root");
        dsc.setPassword("123456");
        dsc.setDbType(DbType.MYSQL);
        mpg.setDataSource(dsc);

        //3、包的配置
        PackageConfig pc = new PackageConfig();
        pc.setModuleName("blog");
        pc.setParent("com.kuang");
        pc.setEntity("entity");
        pc.setMapper("mapper");
        pc.setService("service");
        pc.setController("controller");
        mpg.setPackageInfo(pc);

        //4、策略配置（只需要改这里的表名即可）
        StrategyConfig strategy = new StrategyConfig();
        strategy.setInclude("blog_tags","course","links","sys_settings","user_record","user_say"); // 设置要映射的表名
        strategy.setNaming(NamingStrategy.underline_to_camel);
        strategy.setColumnNaming(NamingStrategy.underline_to_camel);
        strategy.setEntityLombokModel(true); // 自动lombok；
        strategy.setLogicDeleteFieldName("deleted");

        //5、自动填充配置
        TableFill gmtCreate = new TableFill("gmt_create", FieldFill.INSERT);
        TableFill gmtModified = new TableFill("gmt_modified",
        FieldFill.INSERT_UPDATE);
        ArrayList&lt;TableFill&gt; tableFills = new ArrayList&lt;&gt;();
        tableFills.add(gmtCreate);
        tableFills.add(gmtModified);
        strategy.setTableFillList(tableFills);

        //6、乐观锁
        strategy.setVersionFieldName("version");
        strategy.setRestControllerStyle(true);
        strategy.setControllerMappingHyphenStyle(true); //
        localhost:8080/hello_id_2
        mpg.setStrategy(strategy);

        mpg.execute(); //执行
    &#125;
&#125;</code></pre></p>
<p align="right"><br>2020年06月13日 晚上<br>Guzhz</p>
            </article>
            <hr>
            <div>
              <div class="post-metas mb-3">
                
                  <div class="post-meta mr-3">
                    <i class="iconfont icon-category"></i>
                    
                      <a class="hover-with-bg" href="/categories/学习记录/">学习记录</a>
                    
                  </div>
                
                
                  <div class="post-meta">
                    <i class="iconfont icon-tags"></i>
                    
                      <a class="hover-with-bg" href="/tags/mybatis-plus/">mybatis-plus</a>
                    
                  </div>
                
              </div>
              
                <p class="note note-warning">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-sa/4.0/deed.zh" rel="nofollow noopener">CC BY-SA 4.0 协议</a> ，转载请注明出处！</p>
              
              
                <div class="post-prevnext row">
                  <div class="post-prev col-6">
                    
                    
                      <a href="/2020/07/12/在线订餐系统知识点总结/">
                        <i class="iconfont icon-arrowleft"></i>
                        <span class="hidden-mobile">在线订餐系统知识点总结</span>
                        <span class="visible-mobile">上一篇</span>
                      </a>
                    
                  </div>
                  <div class="post-next col-6">
                    
                    
                      <a href="/2020/06/09/JavaScript的简单回顾/">
                        <span class="hidden-mobile">JavaScript的简单回顾</span>
                        <span class="visible-mobile">下一篇</span>
                        <i class="iconfont icon-arrowright"></i>
                      </a>
                    
                  </div>
                </div>
              
            </div>

            
          </div>
        </div>
      </div>
    </div>
    
      <div class="d-none d-lg-block col-lg-2 toc-container" id="toc-ctn">
        <div id="toc">
  <p class="toc-header"><i class="iconfont icon-list"></i>&nbsp;目录</p>
  <div id="tocbot"></div>
</div>

      </div>
    
  </div>
</div>

<!-- Custom -->


    
  </main>

  
    <a id="scroll-top-button" href="#" role="button">
      <i class="iconfont icon-arrowup" aria-hidden="true"></i>
    </a>
  

  
    <div class="modal fade" id="modalSearch" tabindex="-1" role="dialog" aria-labelledby="ModalLabel" aria-hidden="true">
  <div class="modal-dialog modal-dialog-scrollable modal-lg" role="document">
    <div class="modal-content">
      <div class="modal-header text-center">
        <h4 class="modal-title w-100 font-weight-bold">搜索</h4>
        <button type="button" id="local-search-close" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body mx-3">
        <div class="md-form mb-5">
          <input type="text" id="local-search-input" class="form-control validate">
          <label data-error="x" data-success="v" for="local-search-input">关键词</label>
        </div>
        <div class="list-group" id="local-search-result"></div>
      </div>
    </div>
  </div>
</div>
  

  

  

  <footer class="mt-5">
  <div class="text-center py-3">
    <div>
      <a href="https://hexo.io" target="_blank" rel="nofollow noopener"><span>Hexo</span></a>
      <i class="iconfont icon-love"></i>
      <a href="https://github.com/fluid-dev/hexo-theme-fluid" target="_blank" rel="nofollow noopener">
        <span>Fluid</span></a>
    </div>
    
  <div class="statistics">
    
    

    
      
        <!-- 不蒜子统计PV -->
        <span id="busuanzi_container_site_pv" style="display: none">
            总访问量 
            <span id="busuanzi_value_site_pv"></span>
             次
          </span>
      
      
        <!-- 不蒜子统计UV -->
        <span id="busuanzi_container_site_uv" style="display: none">
            总访客数 
            <span id="busuanzi_value_site_uv"></span>
             人
          </span>
      
    
  </div>


    
  <!-- 备案信息 -->
  <div class="beian">
    <a href="http://beian.miit.gov.cn/" target="_blank" rel="nofollow noopener">京ICP备1234556号-1</a>
    
  </div>


    
  </div>
</footer>

<!-- SCRIPTS -->
<script src="https://cdn.staticfile.org/jquery/3.4.1/jquery.min.js"></script>
<script src="https://cdn.staticfile.org/twitter-bootstrap/4.4.1/js/bootstrap.min.js"></script>
<script src="/js/debouncer.js"></script>
<script src="/js/main.js"></script>

<!-- Plugins -->


  
    <script src="/js/lazyload.js"></script>
  



  <script defer src="https://cdn.staticfile.org/clipboard.js/2.0.6/clipboard.min.js"></script>
  <script src="/js/clipboard-use.js"></script>



  <script defer src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>





  <script src="https://cdn.staticfile.org/tocbot/4.11.1/tocbot.min.js"></script>
  <script>
    $(document).ready(function () {
      var boardCtn = $('#board-ctn');
      var boardTop = boardCtn.offset().top;

      tocbot.init({
        tocSelector: '#tocbot',
        contentSelector: 'article.markdown-body',
        headingSelector: 'h1,h2,h3,h4,h5,h6',
        linkClass: 'tocbot-link',
        activeLinkClass: 'tocbot-active-link',
        listClass: 'tocbot-list',
        isCollapsedClass: 'tocbot-is-collapsed',
        collapsibleClass: 'tocbot-is-collapsible',
        collapseDepth: 0,
        scrollSmooth: true,
        headingsOffset: -boardTop
      });
      if ($('.toc-list-item').length > 0) {
        $('#toc').css('visibility', 'visible');
      }
    });
  </script>



  <script src="https://cdn.staticfile.org/typed.js/2.0.11/typed.min.js"></script>
  <script>
    var typed = new Typed('#subtitle', {
      strings: [
        '  ',
        "MyBatisPlus学习笔记&nbsp;",
      ],
      cursorChar: "_",
      typeSpeed: 70,
      loop: false,
    });
    typed.stop();
    $(document).ready(function () {
      $(".typed-cursor").addClass("h2");
      typed.start();
    });
  </script>



  <script src="https://cdn.staticfile.org/anchor-js/4.2.2/anchor.min.js"></script>
  <script>
    anchors.options = {
      placement: "right",
      visible: "hover",
      
    };
    var el = "h1,h2,h3,h4,h5,h6".split(",");
    var res = [];
    for (item of el) {
      res.push(".markdown-body > " + item)
    }
    anchors.add(res.join(", "))
  </script>



  <script src="/js/local-search.js"></script>
  <script>
    var path = "/local-search.xml";
    var inputArea = document.querySelector("#local-search-input");
    inputArea.onclick = function () {
      searchFunc(path, 'local-search-input', 'local-search-result');
      this.onclick = null
    }
  </script>



  <script src="https://cdn.staticfile.org/fancybox/3.5.7/jquery.fancybox.min.js"></script>
  <link rel="stylesheet" href="https://cdn.staticfile.org/fancybox/3.5.7/jquery.fancybox.min.css">

  <script>
    $('#post img:not(.no-zoom img, img[no-zoom]), img[zoom]').each(
      function () {
        var element = document.createElement('a');
        $(element).attr('data-fancybox', 'images');
        $(element).attr('href', $(this).attr('src'));
        $(this).wrap(element);
      }
    );
  </script>

















  

  

  

  

  

  





</body>
</html>
